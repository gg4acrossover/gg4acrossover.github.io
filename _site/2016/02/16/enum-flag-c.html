<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>GG4aCrossover - Blogging about IOS and life</title>
    <meta name="description" content="IOS and something interesting in life" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="/">Home</a>
        <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Enum Flag C++</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-02-16">16 Feb 2016</time>
                
            </section>
        </header>

<!--         <header class="post-header">
            <a id="blog-logo" href="gg4acrossover.github.io">
                
                    <span class="blog-title">GG4aCrossover</span>
                
            </a>
        </header> -->

        <!-- <span class="post-meta">
            <time datetime="2016-02-16">16 Feb 2016</time>
            
        </span> -->

        <!-- <h1 class="post-title">Enum Flag C++</h1> -->

        <section class="post-content">
            <p>Hôm nọ đọc trên DNH có bài hướng dẫn về bit field</p>

<blockquote>
  <p><a href="http://www.wikiwand.com/en/Bit_field">Daynhauhoc</a></p>
</blockquote>

<p>Trong bài đó cũng có phần nói về bit operators. Cái này trong IOS áp dụng tương đối nhiều, nên hôm nay mình sẽ viết 1 cái tip nho nhỏ về bitwise</p>

<h1 id="bitwise">Bitwise</h1>

<p>Sử dụng bitwise trong lập trình nói chung làm cho code của bạn trở nên huyền bí, khó đọc. Tuy nhiên cũng có một số trường hợp áp dụng nó sẽ khiến code trông ngắn gọn, sáng sủa. Giả sử bạn làm game, nhân vật của bạn có thể có nhiều hơn một thuộc tính như CHAO, NORLMAL, MAGIC…Bạn sẽ tạo mấy biến để lưu trữ thuộc tính nhân vật?</p>

<p>Đây là một trường hợp tuyệt vời để áp dụng enum flag, khi đó ta chỉ cần một biến duy nhất để lưu trữ thuộc tính, tránh code rườm rà.
Giống như cách define sau</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#define KEY_UP       (1 &lt;&lt; 0)  </span><span class="c1">// 000001</span>
<span class="cp">#define KEY_RIGHT    (1 &lt;&lt; 1)  </span><span class="c1">// 000010</span>
<span class="cp">#define KEY_DOWN     (1 &lt;&lt; 2)  </span><span class="c1">// 000100</span>
<span class="cp">#define KEY_LEFT     (1 &lt;&lt; 3)  </span><span class="c1">// 001000</span>
<span class="cp">#define KEY_BUTTON1  (1 &lt;&lt; 4)  </span><span class="c1">// 010000</span>
<span class="cp">#define KEY_BUTTON2  (1 &lt;&lt; 5)  </span><span class="c1">// 100000</span></code></pre></figure>

<p>Tuy nhiên mình sẽ không dùng define mà dùng enum làm cờ.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">enum</span> <span class="n">FLAG</span>
<span class="p">{</span>
         <span class="n">UNKNOW</span>    <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
         <span class="n">NORMAL</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
         <span class="n">MAGIC</span>     <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
         <span class="n">CHAO</span>      <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span>
<span class="p">};</span></code></pre></figure>

<p>Hàm main</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
         <span class="n">FLAG</span> <span class="n">flag</span> <span class="o">=</span> <span class="n">MAGIC</span> <span class="o">|</span> <span class="n">CHAO</span><span class="p">;</span>
   
         <span class="k">if</span><span class="p">(</span> <span class="n">flag</span> <span class="o">&amp;</span> <span class="n">NORMAL</span><span class="p">)</span>
         <span class="p">{</span>
         	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Normal&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
         <span class="p">}</span>   
   
         <span class="k">if</span><span class="p">(</span> <span class="n">flag</span> <span class="o">&amp;</span> <span class="n">CHAO</span><span class="p">)</span>
         <span class="p">{</span>
   		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;Chao&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
         <span class="p">}</span>
   
         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span></code></pre></figure>

<p>Tuy nhiên nếu bạn chạy ngay code này thì sẽ lỗi. Ta cần phải overload toán tử | (OR)</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kr">inline</span> <span class="n">FLAG</span> <span class="k">operator</span><span class="o">|</span><span class="p">(</span><span class="n">FLAG</span> <span class="n">a</span><span class="p">,</span> <span class="n">FLAG</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">FLAG</span><span class="o">&gt;</span> <span class="p">(</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">|</span> 
                               <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">));</span>
<span class="p">};</span></code></pre></figure>

<p>OK, bây giờ code đã có thể chạy được. Giải thích một chút nhé:
Khi ta thực hiện phép toán | (OR) giữa CHAO và MAGIC thì ta được (gán cờ để nhân vật mang 2 thuộc tính)</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">MAGIC</span>             <span class="mo">00000010</span> 
<span class="n">CHAO</span>              <span class="mo">00000100</span> 
<span class="n">MAGIC</span> <span class="o">|</span> <span class="n">CHAO</span>      <span class="mo">00000110</span></code></pre></figure>

<p>Khi ta thực hiện phép toán &amp; giữa CHAO và (MAGIC | CHAO) thì ta được (kiểm tra cờ được gán)</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">MAGIC</span> <span class="o">|</span> <span class="n">CHAO</span>      <span class="mo">00000110</span> 
<span class="n">CHAO</span>              <span class="mo">00000100</span>
<span class="n">MAGIC</span> <span class="o">&amp;</span> <span class="n">CHAO</span>      <span class="mo">00000100</span></code></pre></figure>

<p>Kết quả giống như biến CHAO thế nên kết quả của bài trên là hiện ra CHAO.
Để biết ta gắn những cờ nào thì FLAG sẽ thực hiện phép &amp; với cờ đó.</p>

<p>P/S: Lập trình ios thì các bạn sẽ thấy cái này khá nhiều.</p>

        </section>

        

        <footer class="post-footer">
            <!-- If we want to display author's name and bio -->
            
                <figure class="author-image">
                    <a class="img" href="/" style="background-image: url(/assets/images/profile.png)">
                    <span class="hidden">VietHQ's Picture</span></a>
                </figure>
                <section class="author">
                    <!-- Author Name -->
                    <h4> VietHQ </h4>
                    <!-- Author Bio -->
                    <p>
                        Developer nhân dân
                    </p>
                </section>
            

            <!-- Share links section -->
            <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Enum Flag C++&amp;url=https://gg4acrossover.github.io/2016/02/16/enum-flag-c.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://gg4acrossover.github.io/2016/02/16/enum-flag-c.html"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=https://gg4acrossover.github.io/2016/02/16/enum-flag-c.html"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

            <!-- Disqus comments -->
            

        </footer>

    </article>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="/">GG4aCrossover</a> &copy; 
               &bull; All rights reserved.
      </section>
      <section class="poweredby">Made with Jekyll using 
        <a href="http://github.com/rosario/kasper">Kasper theme</a>
      </section>
    </footer>
    
    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', '']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>   
</body>
</html>
